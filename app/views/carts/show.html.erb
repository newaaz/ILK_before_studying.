<% provide(:title, "Запомненное") %>

<% content_for(:javascript_plugin_header) do %>
  <%= javascript_pack_tag 'main/fotorama', 'data-turbolinks-track': 'reload'%>
<% end %>

<div class="collapse" id="collapseMap">
  <div id="map" class="map"></div>
</div>
<!-- End Map -->

<main class="cart">

<div class="container mt-4">

  <div class="row">
    
    <div class="col-lg-9">    

      <% if @cart %>
        <% if @cart.line_items.any? %>

          <h2 class="mb-3">Объекты, которые Вы отметили:</h2>          

          <% if @cart.hotels.any? %>
            <h3>Отели и гостиницы</h3>              
            <%= render partial: "carts/hotel", collection: @cart.hotels %>
          <% end %>

          <% if @cart.cafebars.any? %>
            <h3>Кафе и рестораны</h3> 
            <%= render partial: "carts/cafebar", collection: @cart.cafebars %>              
          <% end %>

          <%= link_to "Назад", :back, class: "btn btn-outline-secondary btn-sm" %>
          <%= link_to "Удалить список", cart_path(@cart, referer_page: @referer_page), method: :delete, class: 'btn btn-outline-danger btn-sm' %>
        
        <% else %>
          <h2>Список избранного пуст</h2>
          <br><br>
          <%= link_to "Назад", :back, class: "btn btn-outline-secondary btn-sm" %>
          <%= link_to "Удалить список", cart_path(@cart, referer_page: @referer_page), method: :delete, class: 'btn btn-outline-danger btn-sm' %>
        <% end %>

      <% else %>
        <h2>Список избранного пуст</h2>
        <h3>Вы пока не добавили в список запомненного</h3>
        <br><br>
        <%= link_to "Назад", :back, class: "btn btn-outline-secondary btn-sm" %>
      <% end %>

      <hr>					

    </div>
  

    <aside class="col-lg-3">
      
    </aside>
  

  </div>

</div>

</main>

<script>//Initialize fotorama manually for hotels widget.
  $(document).on('turbolinks:load', function() {
    $(function () {    

      //Initialize fotorama hotels widget.
      var $fotoramaDiv = $('.fotorama-rooms').fotorama();

      $fotoramaDiv.on('fotorama:fullscreenenter',
        function (e, fotorama) {        
          fotorama.setOptions({
            nav: "thumbs"
          });
        });
      
      $fotoramaDiv.on('fotorama:fullscreenexit',
      function (e, fotorama) {      
        fotorama.setOptions({
          nav: "false"
        });
      })
    });
  }); 
</script>



